const { $ } = require('zx');
const { resolve } = require('path');
const { writeFile } = require('fs/promises');

const tmps = {
  'simple': {
    files: [
      {
        name: 'run.sh',
        content: `#!/bin/sh

rm -rf ./build/* && npx -y docoru build --out ./build && npx -y http-server ./build --port=3000 --host=0.0.0.0 --cors
`,
      },
      {
        name: 'config.yaml',
        content: `assets: "**/*.{svg,png,jpg,jpeg}"
`,
      },
      {
        name: 'nav.yaml',
        content: `title:
  href: "/"
  image: "/api/assets/images/logo.svg"

locale:
  heading: "In the article:"
  prev: "Next"
  next: "Previous"
  search: "Search..."

top:
  - label: Github
    href: https://github.com/makamekm/docoru

left:
  - label: Overview
    href: index
`,
      },
      {
        name: 'index.md',
        content: `# Hello world!

This is the best documentation in the world!
`,
      },
      {
        name: 'images/logo.svg',
        content: `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106.33 23.76">
  <defs>
    <style>
      .cls-1 {
        fill: #662d91;
        stroke-width: 0px;
      }
    </style>
  </defs>
  <g>
    <path class="cls-1" d="m16.57,16.48l-.35.35.24.47-.47-.12-.35.24-.35-.24-.05-.45-.56-.06-.07-.07-.58.03-.18-.64-.15,1.26-.24-.11.22.67.76.43h-.46s-.11.47-.11.47l-.59-.24-.24.24-.13-.36.14-.27-.19-.85-.23.52-.25-1.16-.46-.25-.77.09.68-.53-3.4.67,2.01-.85-4.08.39,1.68-.79-3.36-.29,7.13-2.15-1.19-.56,2.46-.14-4.84-1.84,2.71.11-3.18-.9-1.96-2.53,1.86.61-2.75-2.99-.56-2.56,2.95,2.53L4.88,0l11.49,10.03.3.05,1.43-.61,2.23.58-.07.54.53.16.34,1.11-1.79-.31-3.42,3-.53,1.56.23.36h.94Z"/>
    <polygon class="cls-1" points="13.26 20.76 25.65 17.16 26.26 17.69 13.26 23.76 0 17.58 .61 17.16 13.26 20.76"/>
    <polygon class="cls-1" points="14.38 4.47 15.43 6.38 14.75 3.68 15.33 2.29 15.84 3.95 16.12 1.01 19.06 7.67 18.65 8.97 16.49 9.29 14.2 6.36 14.38 4.47 14.38 4.47"/>
  </g>
  <g>
    <path class="cls-1" d="m38,3.18c1.33,0,2.43.41,3.3,1.22.87.82,1.31,1.95,1.31,3.41v8.47c0,1.52-.43,2.67-1.28,3.44-.86.78-1.96,1.16-3.32,1.16h-5.76l.22-.22V3.4l-.22-.22h5.76Zm.74,13.1V7.81c0-.21-.07-.39-.22-.54-.14-.15-.32-.23-.53-.23h-1.68v9.98h1.68c.21,0,.38-.07.53-.22.14-.14.22-.32.22-.53Z"/>
    <path class="cls-1" d="m50.5,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m62.19,7.81v8.47c0,.21.08.38.23.53s.33.22.54.22h4.1v3.86h-4.1c-1.28,0-2.37-.45-3.28-1.34-.9-.9-1.36-1.98-1.36-3.26V7.81c0-1.28.45-2.37,1.36-3.28.9-.9,2-1.36,3.28-1.36h3.91v3.86h-3.91c-.21,0-.39.08-.54.23-.15.15-.23.33-.23.54Z"/>
    <path class="cls-1" d="m74.65,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m82.5,20.68V3.4l-.22-.22h6.02c1.34,0,2.45.38,3.32,1.14.87.76,1.31,1.86,1.31,3.3v3.5c0,1.63-.61,2.78-1.82,3.43l2.35,6.12.22.22h-4.54l.24-.22-1.66-5.21h-1.37v5.21l.24.22h-4.32l.22-.22Zm3.86-13.8v5.06h1.94c.21,0,.39-.07.54-.22.15-.14.23-.32.23-.53v-3.58c0-.21-.08-.38-.23-.53-.15-.14-.33-.22-.54-.22h-1.94Z"/>
    <path class="cls-1" d="m106.33,3.18l-.24.24v12.72c0,1.54-.52,2.73-1.56,3.58s-2.34,1.27-3.89,1.27-2.78-.43-3.88-1.28-1.64-2.04-1.64-3.56V3.4l-.02.02-.22-.24h4.46l-.24.24v-.02,12.74c0,.46.25.8.74,1s1,.2,1.5.01c.5-.19.76-.53.76-1.01V3.4v.02l-.24-.24h4.46Z"/>
  </g>
</svg>
`,
      },
    ],
  },
  'langs': {
    files: [
      {
        name: 'run.sh',
        content: `#!/bin/sh

rm -rf ./build/* && npx -y docoru build --out ./build && npx -y http-server ./build --port=3000 --host=0.0.0.0 --cors
`,
      },
      {
        name: 'config.yaml',
        content: `languages:
  - label: Русский
    flag: ru
    code: ru
  - label: English
    flag: en
    code: en

assets: "**/*.{svg,png,jpg,jpeg}"

redirects:
  - from: /
    to: hello.en
    normalize: false
  - from: /
    to: hello
`,
      },
      {
        name: 'en/nav.yaml',
        content: `title:
  href: "/"
  image: "/api/assets/images/logo.svg"

locale:
  heading: "In the article:"
  prev: "Next"
  next: "Previous"
  search: "Search..."

top:
  - label: Github
    href: https://github.com/makamekm/docoru

left:
  - label: Overview
    href: hello
`,
      },
      {
        name: 'en/hello.md',
        content: `# Hello world!

This is the best documentation in the world!
`,
      },
      {
        name: 'ru/nav.yaml',
        content: `title:
  href: "/"
  image: "/api/assets/images/logo.svg"

locale:
  heading: "В этой статье:"
  prev: "Предыдущая"
  next: "Следующая"
  search: "Поиск..."

top:
  - label: Github
    href: https://github.com/makamekm/docoru

left:
  - label: Overview
    href: hello
`,
      },
      {
        name: 'ru/hello.md',
        content: `# Привет Мир!

Это лучшая документация в мире!
`,
      },
      {
        name: 'images/logo.svg',
        content: `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106.33 23.76">
  <defs>
    <style>
      .cls-1 {
        fill: #662d91;
        stroke-width: 0px;
      }
    </style>
  </defs>
  <g>
    <path class="cls-1" d="m16.57,16.48l-.35.35.24.47-.47-.12-.35.24-.35-.24-.05-.45-.56-.06-.07-.07-.58.03-.18-.64-.15,1.26-.24-.11.22.67.76.43h-.46s-.11.47-.11.47l-.59-.24-.24.24-.13-.36.14-.27-.19-.85-.23.52-.25-1.16-.46-.25-.77.09.68-.53-3.4.67,2.01-.85-4.08.39,1.68-.79-3.36-.29,7.13-2.15-1.19-.56,2.46-.14-4.84-1.84,2.71.11-3.18-.9-1.96-2.53,1.86.61-2.75-2.99-.56-2.56,2.95,2.53L4.88,0l11.49,10.03.3.05,1.43-.61,2.23.58-.07.54.53.16.34,1.11-1.79-.31-3.42,3-.53,1.56.23.36h.94Z"/>
    <polygon class="cls-1" points="13.26 20.76 25.65 17.16 26.26 17.69 13.26 23.76 0 17.58 .61 17.16 13.26 20.76"/>
    <polygon class="cls-1" points="14.38 4.47 15.43 6.38 14.75 3.68 15.33 2.29 15.84 3.95 16.12 1.01 19.06 7.67 18.65 8.97 16.49 9.29 14.2 6.36 14.38 4.47 14.38 4.47"/>
  </g>
  <g>
    <path class="cls-1" d="m38,3.18c1.33,0,2.43.41,3.3,1.22.87.82,1.31,1.95,1.31,3.41v8.47c0,1.52-.43,2.67-1.28,3.44-.86.78-1.96,1.16-3.32,1.16h-5.76l.22-.22V3.4l-.22-.22h5.76Zm.74,13.1V7.81c0-.21-.07-.39-.22-.54-.14-.15-.32-.23-.53-.23h-1.68v9.98h1.68c.21,0,.38-.07.53-.22.14-.14.22-.32.22-.53Z"/>
    <path class="cls-1" d="m50.5,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m62.19,7.81v8.47c0,.21.08.38.23.53s.33.22.54.22h4.1v3.86h-4.1c-1.28,0-2.37-.45-3.28-1.34-.9-.9-1.36-1.98-1.36-3.26V7.81c0-1.28.45-2.37,1.36-3.28.9-.9,2-1.36,3.28-1.36h3.91v3.86h-3.91c-.21,0-.39.08-.54.23-.15.15-.23.33-.23.54Z"/>
    <path class="cls-1" d="m74.65,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m82.5,20.68V3.4l-.22-.22h6.02c1.34,0,2.45.38,3.32,1.14.87.76,1.31,1.86,1.31,3.3v3.5c0,1.63-.61,2.78-1.82,3.43l2.35,6.12.22.22h-4.54l.24-.22-1.66-5.21h-1.37v5.21l.24.22h-4.32l.22-.22Zm3.86-13.8v5.06h1.94c.21,0,.39-.07.54-.22.15-.14.23-.32.23-.53v-3.58c0-.21-.08-.38-.23-.53-.15-.14-.33-.22-.54-.22h-1.94Z"/>
    <path class="cls-1" d="m106.33,3.18l-.24.24v12.72c0,1.54-.52,2.73-1.56,3.58s-2.34,1.27-3.89,1.27-2.78-.43-3.88-1.28-1.64-2.04-1.64-3.56V3.4l-.02.02-.22-.24h4.46l-.24.24v-.02,12.74c0,.46.25.8.74,1s1,.2,1.5.01c.5-.19.76-.53.76-1.01V3.4v.02l-.24-.24h4.46Z"/>
  </g>
</svg>
`,
      },
    ],
  },
  'lang': {
    files: [
      {
        name: 'run.sh',
        content: `#!/bin/sh

rm -rf ./build/* && npx -y docoru build --out ./build && npx -y http-server ./build --port=3000 --host=0.0.0.0 --cors
`,
      },
      {
        name: 'config.yaml',
        content: `language: ru

languages:
  - label: Русский
    flag: ru
    code: ru
  - label: English
    flag: en
    code: en

assets: "**/*.{svg,png,jpg,jpeg}"
`,
      },
      {
        name: 'en/nav.yaml',
        content: `title:
  href: "/"
  image: "/api/assets/images/logo.svg"

locale:
  heading: "In the article:"
  prev: "Next"
  next: "Previous"
  search: "Search..."

top:
  - label: Github
    href: https://github.com/makamekm/docoru

left:
  - label: Overview
    href: index
`,
      },
      {
        name: 'en/index.md',
        content: `# Hello world!

This is the best documentation in the world!
`,
      },
      {
        name: 'ru/nav.yaml',
        content: `title:
  href: "/"
  image: "/api/assets/images/logo.svg"

locale:
  heading: "В этой статье:"
  prev: "Предыдущая"
  next: "Следующая"
  search: "Поиск..."

top:
  - label: Github
    href: https://github.com/makamekm/docoru

left:
  - label: Overview
    href: index
`,
      },
      {
        name: 'ru/index.md',
        content: `# Привет Мир!

Это лучшая документация в мире!
`,
      },
      {
        name: 'images/logo.svg',
        content: `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106.33 23.76">
  <defs>
    <style>
      .cls-1 {
        fill: #662d91;
        stroke-width: 0px;
      }
    </style>
  </defs>
  <g>
    <path class="cls-1" d="m16.57,16.48l-.35.35.24.47-.47-.12-.35.24-.35-.24-.05-.45-.56-.06-.07-.07-.58.03-.18-.64-.15,1.26-.24-.11.22.67.76.43h-.46s-.11.47-.11.47l-.59-.24-.24.24-.13-.36.14-.27-.19-.85-.23.52-.25-1.16-.46-.25-.77.09.68-.53-3.4.67,2.01-.85-4.08.39,1.68-.79-3.36-.29,7.13-2.15-1.19-.56,2.46-.14-4.84-1.84,2.71.11-3.18-.9-1.96-2.53,1.86.61-2.75-2.99-.56-2.56,2.95,2.53L4.88,0l11.49,10.03.3.05,1.43-.61,2.23.58-.07.54.53.16.34,1.11-1.79-.31-3.42,3-.53,1.56.23.36h.94Z"/>
    <polygon class="cls-1" points="13.26 20.76 25.65 17.16 26.26 17.69 13.26 23.76 0 17.58 .61 17.16 13.26 20.76"/>
    <polygon class="cls-1" points="14.38 4.47 15.43 6.38 14.75 3.68 15.33 2.29 15.84 3.95 16.12 1.01 19.06 7.67 18.65 8.97 16.49 9.29 14.2 6.36 14.38 4.47 14.38 4.47"/>
  </g>
  <g>
    <path class="cls-1" d="m38,3.18c1.33,0,2.43.41,3.3,1.22.87.82,1.31,1.95,1.31,3.41v8.47c0,1.52-.43,2.67-1.28,3.44-.86.78-1.96,1.16-3.32,1.16h-5.76l.22-.22V3.4l-.22-.22h5.76Zm.74,13.1V7.81c0-.21-.07-.39-.22-.54-.14-.15-.32-.23-.53-.23h-1.68v9.98h1.68c.21,0,.38-.07.53-.22.14-.14.22-.32.22-.53Z"/>
    <path class="cls-1" d="m50.5,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m62.19,7.81v8.47c0,.21.08.38.23.53s.33.22.54.22h4.1v3.86h-4.1c-1.28,0-2.37-.45-3.28-1.34-.9-.9-1.36-1.98-1.36-3.26V7.81c0-1.28.45-2.37,1.36-3.28.9-.9,2-1.36,3.28-1.36h3.91v3.86h-3.91c-.21,0-.39.08-.54.23-.15.15-.23.33-.23.54Z"/>
    <path class="cls-1" d="m74.65,2.92c1.76,0,3.1.46,4.03,1.38.93.92,1.39,2.04,1.39,3.37v8.66c0,1.31-.47,2.44-1.42,3.37-.94.94-2.28,1.4-4.01,1.4s-3.06-.47-4.04-1.42c-.98-.94-1.48-2.06-1.48-3.36V7.67c0-1.33.47-2.45,1.4-3.37.94-.92,2.31-1.38,4.12-1.38Zm1.56,13.42V7.67c0-.45-.27-.76-.8-.95s-1.07-.18-1.61.01c-.54.19-.8.5-.8.94v8.66c0,.51.27.87.8,1.07.54.2,1.07.2,1.61-.01s.8-.56.8-1.06Z"/>
    <path class="cls-1" d="m82.5,20.68V3.4l-.22-.22h6.02c1.34,0,2.45.38,3.32,1.14.87.76,1.31,1.86,1.31,3.3v3.5c0,1.63-.61,2.78-1.82,3.43l2.35,6.12.22.22h-4.54l.24-.22-1.66-5.21h-1.37v5.21l.24.22h-4.32l.22-.22Zm3.86-13.8v5.06h1.94c.21,0,.39-.07.54-.22.15-.14.23-.32.23-.53v-3.58c0-.21-.08-.38-.23-.53-.15-.14-.33-.22-.54-.22h-1.94Z"/>
    <path class="cls-1" d="m106.33,3.18l-.24.24v12.72c0,1.54-.52,2.73-1.56,3.58s-2.34,1.27-3.89,1.27-2.78-.43-3.88-1.28-1.64-2.04-1.64-3.56V3.4l-.02.02-.22-.24h4.46l-.24.24v-.02,12.74c0,.46.25.8.74,1s1,.2,1.5.01c.5-.19.76-.53.76-1.01V3.4v.02l-.24-.24h4.46Z"/>
  </g>
</svg>
`,
      },
    ],
  },
};

async function initProject(dir, type) {
  const project = tmps[type] ?? tmps['simple'];
  for (const { name, content } of project.files) {
    await $`mkdir -p ${resolve(dir, name, '..')}`;
    await writeFile(resolve(dir, name), content, 'utf-8');
  }
}

module.exports = {
  initProject,
};
